---
title: Hi·ªÉu s√¢u v·ªÅ Prototype v√† Class trong JavaScript
published: 2025-10-18
tags:
  - JavaScript
  - OOP
  - Prototype
  - Class
  - Inheritance
  - ES6
toc: true
lang: vi
abbrlink: javascript-prototype-class
description: Ph√¢n t√≠ch s√¢u Prototype chain, Class syntax v√† inheritance trong JavaScript. Hi·ªÉu t·∫°i sao Class ch·ªâ l√† "syntactic sugar" v√† c√°ch JavaScript OOP ho·∫°t ƒë·ªông th·ª±c s·ª±.
image:
    url: '/images/js.png'
    alt: 'JavaScript Prototype and Class'
---

JavaScript c√≥ c∆° ch·∫ø OOP kh√°c bi·ªát so v·ªõi c√°c ng√¥n ng·ªØ kh√°c. Thay v√¨ class-based, JS s·ª≠ d·ª•ng **prototype-based inheritance**. H√£y c√πng hi·ªÉu s√¢u v·ªÅ c∆° ch·∫ø n√†y v√† t·∫°i sao ES6 Class ch·ªâ l√† "syntactic sugar".

## JavaScript kh√¥ng c√≥ Class th·∫≠t s·ª±! üò±

Nghe c√≥ v·∫ª l·∫°, nh∆∞ng JavaScript **kh√¥ng c√≥ class th·∫≠t s·ª±** nh∆∞ Java, C#. M·ªçi th·ª© ƒë·ªÅu d·ª±a tr√™n **Objects** v√† **Prototypes**.

```javascript
// ‚ùå T∆∞·ªüng l√† class, nh∆∞ng th·ª±c ra l√†...
class Person {
    constructor(name) {
        this.name = name;
    }
}

// ‚úÖ Th·ª±c t·∫ø JavaScript t·∫°o ra:
console.log(typeof Person); // "function"
console.log(Person.prototype); // Object v·ªõi constructor
```

## Prototype l√† g√¨? üîó

**Prototype** l√† m·ªôt object ƒë·∫∑c bi·ªát m√† m·ªçi function trong JS ƒë·ªÅu c√≥. N√≥ l√† "template" ƒë·ªÉ t·∫°o ra c√°c objects m·ªõi.

### Function v√† Prototype

```javascript
// M·ªçi function ƒë·ªÅu c√≥ property 'prototype'
function Person(name) {
    this.name = name;
}

console.log(Person.prototype); // {}
console.log(typeof Person.prototype); // "object"

// Th√™m method v√†o prototype
Person.prototype.greet = function() {
    return `Hi, I'm ${this.name}`;
};

// T·∫°o instance
const harry = new Person('Harry');
console.log(harry.greet()); // "Hi, I'm Harry"
```

### Prototype Chain

M·ªói object c√≥ m·ªôt internal link `[[Prototype]]` (accessible qua `__proto__`):

```javascript
const harry = new Person('Harry');

console.log(harry.__proto__ === Person.prototype); // true
console.log(Person.prototype.__proto__ === Object.prototype); // true
console.log(Object.prototype.__proto__); // null (top c·ªßa chain)

// Prototype chain: harry ‚Üí Person.prototype ‚Üí Object.prototype ‚Üí null
```

## C√°ch ho·∫°t ƒë·ªông c·ªßa Prototype Chain üîç

### Property Lookup

JavaScript t√¨m properties theo th·ª© t·ª±:

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.species = 'Homo sapiens';
Object.prototype.planet = 'Earth';

const harry = new Person('Harry');
harry.age = 25;

// Lookup order:
console.log(harry.age);     // 25 (own property)
console.log(harry.name);    // "Harry" (own property)  
console.log(harry.species); // "Homo sapiens" (t·ª´ Person.prototype)
console.log(harry.planet);  // "Earth" (t·ª´ Object.prototype)
console.log(harry.unknown); // undefined (kh√¥ng t√¨m th·∫•y)
```

### hasOwnProperty vs in operator

```javascript
const harry = new Person('Harry');

console.log('name' in harry);          // true
console.log(harry.hasOwnProperty('name')); // true

console.log('species' in harry);       // true (inherited)
console.log(harry.hasOwnProperty('species')); // false

// Ch·ªâ l·∫•y own properties
console.log(Object.keys(harry));       // ['name']
console.log(Object.getOwnPropertyNames(harry)); // ['name']
```

## Constructor Functions - C√°ch c≈© t·∫°o "Class" üèóÔ∏è

### Basic Constructor

```javascript
function Person(name, age) {
    // Instance properties
    this.name = name;
    this.age = age;
}

// Shared methods tr√™n prototype
Person.prototype.greet = function() {
    return `Hello, I'm ${this.name}`;
};

Person.prototype.getAge = function() {
    return this.age;
};

// Static method
Person.createAnonymous = function() {
    return new Person('Anonymous', 0);
};

// Usage
const harry = new Person('Harry', 25);
console.log(harry.greet()); // "Hello, I'm Harry"

const anon = Person.createAnonymous();
```

### Inheritance v·ªõi Prototypes

```javascript
// Base constructor
function Animal(name) {
    this.name = name;
}

Animal.prototype.eat = function() {
    return `${this.name} is eating`;
};

// Child constructor  
function Dog(name, breed) {
    Animal.call(this, name); // Call parent constructor
    this.breed = breed;
}

// Set up inheritance
Dog.prototype = Object.create(Animal.prototype);
Dog.prototype.constructor = Dog;

// Add child methods
Dog.prototype.bark = function() {
    return `${this.name} says Woof!`;
};

// Usage
const buddy = new Dog('Buddy', 'Golden Retriever');
console.log(buddy.eat());  // "Buddy is eating" (inherited)
console.log(buddy.bark()); // "Buddy says Woof!"

// Ki·ªÉm tra inheritance
console.log(buddy instanceof Dog);    // true
console.log(buddy instanceof Animal); // true
```

## ES6 Classes - Syntactic Sugar üç¨

ES6 Class ch·ªâ l√† c√°ch vi·∫øt ƒë·∫πp h∆°n cho prototype pattern:

### Class Declaration

```javascript
class Person {
    // Constructor method
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    // Instance methods (t·ª± ƒë·ªông th√™m v√†o prototype)
    greet() {
        return `Hello, I'm ${this.name}`;
    }
    
    getAge() {
        return this.age;
    }
    
    // Static methods
    static createAnonymous() {
        return new Person('Anonymous', 0);
    }
    
    // Getter/Setter
    get info() {
        return `${this.name} (${this.age})`;
    }
    
    set info(value) {
        const [name, age] = value.split(' ');
        this.name = name;
        this.age = parseInt(age);
    }
}

// Usage gi·ªëng h·ªát constructor function
const harry = new Person('Harry', 25);
console.log(harry.greet()); // "Hello, I'm Harry"
```

### Class Inheritance

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
    
    eat() {
        return `${this.name} is eating`;
    }
}

class Dog extends Animal {
    constructor(name, breed) {
        super(name); // G·ªçi parent constructor
        this.breed = breed;
    }
    
    bark() {
        return `${this.name} says Woof!`;
    }
    
    // Override method
    eat() {
        return super.eat() + ' dog food';
    }
}

const buddy = new Dog('Buddy', 'Golden Retriever');
console.log(buddy.eat());  // "Buddy is eating dog food"
console.log(buddy.bark()); // "Buddy says Woof!"
```

## So s√°nh: Constructor vs Class üîÑ

C√πng m·ªôt k·∫øt qu·∫£, 2 c√°ch vi·∫øt kh√°c nhau:

### Constructor Function Way

```javascript
// ‚úÖ Constructor Function (ES5)
function Vehicle(brand) {
    this.brand = brand;
    this.speed = 0;
}

Vehicle.prototype.start = function() {
    return `${this.brand} started`;
};

Vehicle.prototype.accelerate = function(amount) {
    this.speed += amount;
    return `Speed: ${this.speed}km/h`;
};

function Car(brand, doors) {
    Vehicle.call(this, brand);
    this.doors = doors;
}

Car.prototype = Object.create(Vehicle.prototype);
Car.prototype.constructor = Car;

Car.prototype.honk = function() {
    return `${this.brand} goes Beep!`;
};
```

### Class Way

```javascript
// ‚úÖ Class Syntax (ES6)  
class Vehicle {
    constructor(brand) {
        this.brand = brand;
        this.speed = 0;
    }
    
    start() {
        return `${this.brand} started`;
    }
    
    accelerate(amount) {
        this.speed += amount;
        return `Speed: ${this.speed}km/h`;
    }
}

class Car extends Vehicle {
    constructor(brand, doors) {
        super(brand);
        this.doors = doors;
    }
    
    honk() {
        return `${this.brand} goes Beep!`;
    }
}
```

### K·∫øt qu·∫£ gi·ªëng h·ªát nhau!

```javascript
// C·∫£ 2 c√°ch t·∫°o ra same prototype structure
const car1 = new Car('Toyota', 4);
console.log(car1.__proto__ === Car.prototype); // true
console.log(Car.prototype.__proto__ === Vehicle.prototype); // true

// Same methods
console.log(car1.start());     // "Toyota started"
console.log(car1.honk());      // "Toyota goes Beep!"
console.log(car1 instanceof Car);     // true
console.log(car1 instanceof Vehicle); // true
```

## T·∫°i sao Class l√† "Syntactic Sugar"? üç≠

### 1. Class v·∫´n t·∫°o ra Functions

```javascript
class MyClass {}

console.log(typeof MyClass); // "function"
console.log(MyClass.prototype); // Object
console.log(MyClass.prototype.constructor === MyClass); // true
```

### 2. Methods v·∫´n tr√™n Prototype

```javascript
class Person {
    greet() { return 'Hello'; }
}

const p = new Person();
console.log(p.hasOwnProperty('greet')); // false
console.log(Person.prototype.hasOwnProperty('greet')); // true
```

### 3. Inheritance v·∫´n d√πng Prototype Chain

```javascript
class Parent {}
class Child extends Parent {}

console.log(Child.prototype.__proto__ === Parent.prototype); // true
```

### 4. C√≥ th·ªÉ mix Constructor v√† Class

```javascript
// Constructor function
function Animal(name) {
    this.name = name;
}

Animal.prototype.eat = function() {
    return 'eating';
};

// Class extends Constructor!
class Dog extends Animal {
    bark() {
        return 'woof';
    }
}

const dog = new Dog('Buddy');
console.log(dog.eat());  // "eating" (t·ª´ constructor)
console.log(dog.bark()); // "woof" (t·ª´ class)
```

## Advanced Prototype Patterns üéØ

### 1. Dynamic Method Addition

```javascript
class Calculator {
    add(a, b) { return a + b; }
}

// Runtime th√™m method
Calculator.prototype.multiply = function(a, b) {
    return a * b;
};

const calc = new Calculator();
console.log(calc.multiply(3, 4)); // 12

// Th·∫≠m ch√≠ th√™m v√†o built-in objects (kh√¥ng khuy·∫øn kh√≠ch)
// String.prototype.reverse = function() {
//     return this.split('').reverse().join('');
// };
```

### 2. Prototype Pollution (Security Issue)

```javascript
// ‚ùå Nguy hi·ªÉm - Prototype pollution
const userInput = JSON.parse('{"__proto__": {"polluted": true}}');

// T·∫•t c·∫£ objects b·ªã ·∫£nh h∆∞·ªüng
console.log({}.polluted); // true

// ‚úÖ An to√†n h∆°n
const safe = Object.create(null); // Kh√¥ng c√≥ prototype
safe.__proto__ = { polluted: true };
console.log(safe.polluted); // undefined
```

### 3. Factory Pattern v·ªõi Prototypes

```javascript
function createShape(type) {
    const shapes = {
        circle: Circle,
        square: Square
    };
    
    const Shape = shapes[type];
    return Shape ? new Shape() : null;
}

function Circle() {
    this.type = 'circle';
}

Circle.prototype.area = function(radius) {
    return Math.PI * radius * radius;
};

function Square() {
    this.type = 'square';  
}

Square.prototype.area = function(side) {
    return side * side;
};

const circle = createShape('circle');
console.log(circle.area(5)); // 78.54
```

## Modern JavaScript OOP Best Practices üí°

### 1. Prefer Composition over Inheritance

```javascript
// ‚ùå Deep inheritance hierarchy
class Animal {}
class Mammal extends Animal {}
class Dog extends Mammal {}
class Poodle extends Dog {}

// ‚úÖ Composition - Linh ho·∫°t h∆°n
class Dog {
    constructor(name) {
        this.name = name;
        this.behaviors = {
            eating: new EatingBehavior(),
            walking: new WalkingBehavior(),
            barking: new BarkingBehavior()
        };
    }
    
    eat() { return this.behaviors.eating.execute(this.name); }
    walk() { return this.behaviors.walking.execute(this.name); }
    bark() { return this.behaviors.barking.execute(this.name); }
}
```

### 2. Use Private Fields (ES2022)

```javascript
class BankAccount {
    // Private fields
    #balance = 0;
    #accountNumber;
    
    constructor(accountNumber) {
        this.#accountNumber = accountNumber;
    }
    
    // Private method
    #validateAmount(amount) {
        return amount > 0 && typeof amount === 'number';
    }
    
    deposit(amount) {
        if (this.#validateAmount(amount)) {
            this.#balance += amount;
        }
    }
    
    getBalance() {
        return this.#balance;
    }
}

const account = new BankAccount('123456');
account.deposit(100);
console.log(account.getBalance()); // 100

// ‚ùå Kh√¥ng th·ªÉ access private
// console.log(account.#balance); // SyntaxError
```

### 3. Static Blocks (ES2022)

```javascript
class Config {
    static #instance;
    static #initialized = false;
    
    // Static initialization block
    static {
        console.log('Config class initialized');
        this.#instance = new Config();
        this.#initialized = true;
    }
    
    static getInstance() {
        return this.#instance;
    }
}

const config1 = Config.getInstance();
const config2 = Config.getInstance();
console.log(config1 === config2); // true (singleton)
```

## Performance Considerations ‚ö°

### 1. Method Definition Location

```javascript
class Person {
    constructor(name) {
        this.name = name;
        
        // ‚ùå T·∫°o function m·ªõi cho m·ªói instance
        this.greet = function() {
            return `Hi ${this.name}`;
        };
    }
}

class PersonOptimized {
    constructor(name) {
        this.name = name;
    }
    
    // ‚úÖ Method tr√™n prototype - share cho t·∫•t c·∫£ instances
    greet() {
        return `Hi ${this.name}`;
    }
}

// Memory usage
const people = Array.from({length: 1000}, (_, i) => new Person(`Person${i}`));
// vs
const peopleOpt = Array.from({length: 1000}, (_, i) => new PersonOptimized(`Person${i}`));
```

### 2. Prototype Chain Length

```javascript
// ‚ùå Chain qu√° d√†i - Ch·∫≠m lookup
class A {}
class B extends A {}  
class C extends B {}
class D extends C {}
class E extends D {} // Qu√° s√¢u!

// ‚úÖ Composition thay inheritance
class E {
    constructor() {
        this.aFeature = new AFeature();
        this.bFeature = new BFeature();
    }
}
```

## K·∫øt lu·∫≠n üìã

### Key Takeaways:

1. **JavaScript = Prototype-based OOP**, kh√¥ng ph·∫£i class-based
2. **ES6 Class = Syntactic sugar** cho constructor functions  
3. **Prototype chain** quy·∫øt ƒë·ªãnh property lookup
4. **Inheritance** th·ª±c s·ª± di·ªÖn ra qua `[[Prototype]]` links
5. **Performance**: Methods tr√™n prototype t·ªët h∆°n trong constructor

### Khi n√†o d√πng g√¨:

| Pattern | Khi n√†o d√πng | ∆Øu ƒëi·ªÉm |
|---------|--------------|---------|
| **Constructor Function** | Legacy code, c·∫ßn hi·ªÉu s√¢u | R√µ r√†ng c∆° ch·∫ø prototype |
| **ES6 Class** | Code m·ªõi, team l·ªõn | D·ªÖ ƒë·ªçc, quen thu·ªôc v·ªõi dev kh√°c ng√¥n ng·ªØ |
| **Factory Function** | C·∫ßn flexibility cao | Tr√°nh `new`, closures, composition |
| **Object.create()** | Fine-grained control | Ki·ªÉm so√°t prototype chain |

### Best Practices:

- ‚úÖ D√πng **Class syntax** cho code m·ªõi (readable)
- ‚úÖ Hi·ªÉu **prototype mechanism** (debugging)  
- ‚úÖ **Composition > Inheritance** (maintainable)
- ‚úÖ **Private fields** cho encapsulation (ES2022+)
- ‚ùå Tr√°nh **prototype pollution**
- ‚ùå Tr√°nh **deep inheritance chains**

JavaScript OOP kh√°c bi·ªát nh∆∞ng r·∫•t m·∫°nh m·∫Ω khi hi·ªÉu ƒë√∫ng c√°ch! üöÄ